esphome:
  name: luz-de-natal
  friendly_name: Luz de Natal

  on_boot:
    priority: -100
    then:
      - lambda: |-
          auto now = id(horario_atual).now();
          if (!now.is_valid()) return;

          int hora = now.hour;
          if (hora >= 18 || hora < 6) {
            id(rele_1).turn_on();
            id(rele_2).turn_on();
            id(rele_3).turn_on();
          } else {
            id(rele_1).turn_off();
            id(rele_2).turn_off();
            id(rele_3).turn_off();
          }

esp8266:
  board: d1

logger:

api:
  encryption:
    key: ""

ota:
  - platform: esphome
    password: ""

wifi:
  ssid: !secret wifi_ssid
  password: !secret wifi_password
  min_auth_mode: WPA2

# ------------------------------------
# TIME (NTP)
# ------------------------------------
time:
  - platform: sntp
    id: horario_atual
    timezone: America/Sao_Paulo
    servers:
      - a.st1.ntp.br

    # LIGA Ã s 18:00
    on_time:
      - seconds: 0
        minutes: 0
        hours: 18
        then:
          - logger.log: "âš¡ RelÃ©s LIGADOS (Noite)"
          - switch.turn_on: rele_1
          - switch.turn_on: rele_2
          - switch.turn_on: rele_3

      # DESLIGA Ã s 06:00
      - seconds: 0
        minutes: 0
        hours: 6
        then:
          - logger.log: "ðŸ’¤ RelÃ©s DESLIGADOS (Dia)"
          - switch.turn_off: rele_1
          - switch.turn_off: rele_2
          - switch.turn_off: rele_3

# ------------------------------------
# RELÃ‰S
# ------------------------------------
switch:
  - platform: gpio
    name: "RelÃ© 1"
    id: rele_1
    pin:
      number: D5
      inverted: true
    restore_mode: ALWAYS_OFF

  - platform: gpio
    name: "RelÃ© 2"
    id: rele_2
    pin:
      number: D6
      inverted: true
    restore_mode: ALWAYS_OFF

  - platform: gpio
    name: "RelÃ© 3"
    id: rele_3
    pin:
      number: D7
      inverted: true
    restore_mode: ALWAYS_OFF
